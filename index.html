<!DOCTYPE html>
<html>
<head>
<!-- Bootstrap 5.0.2 -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
  crossorigin="anonymous"
>
<!-- Font Awesome 6.3.0 -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
  integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
/>
<!-- jQuery 3.6.3-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<!-- DataTables -->
<script src="https://cdn.datatables.net/1.13.2/css/dataTables.bootstrap5.min.css"></script>
<script src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.2/js/dataTables.bootstrap5.min.js"></script>
<script>
  class DieFace {
    constructor(face) {
      this.face = face;
      this.possibleOutcomes = {
        "BLANK":              {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0},
        "SUCCESS":            {'s': 1, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0},
        "ADVANTAGE":          {'s': 0, 'a': 1, 'f': 0, 't': 0, 'T': 0, 'D': 0},
        "SUCCESS ADVANTAGE":  {'s': 1, 'a': 1, 'f': 0, 't': 0, 'T': 0, 'D': 0},
        "DOUBLE SUCCESS":     {'s': 2, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0},
        "DOUBLE ADVANTAGE":   {'s': 0, 'a': 2, 'f': 0, 't': 0, 'T': 0, 'D': 0},
        "TRIUMPH":            {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 1, 'D': 0},
        "FAILURE":            {'s': 0, 'a': 0, 'f': 1, 't': 0, 'T': 0, 'D': 0},
        "THREAT":             {'s': 0, 'a': 0, 'f': 0, 't': 1, 'T': 0, 'D': 0},
        "FAILURE THREAT":     {'s': 0, 'a': 0, 'f': 1, 't': 1, 'T': 0, 'D': 0},
        "DOUBLE FAILURE":     {'s': 0, 'a': 0, 'f': 2, 't': 0, 'T': 0, 'D': 0},
        "DOUBLE THREAT":      {'s': 0, 'a': 0, 'f': 0, 't': 2, 'T': 0, 'D': 0},
        "DESPAIR":            {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 1},
      }
      this.value = this.possibleOutcomes[face.toUpperCase()];
    }
  }
  class Modifiers {
    constructor (modList) {
      this['s'] = modList[0];
      this['a'] = modList[1];
      this['f'] = modList[2];
      this['t'] = modList[3];
      this['T'] = modList[4];
      this['D'] = modList[5];
    }
  }
  class Die {
    constructor(numFaces, name) {
      this.result;
      this.numFaces = numFaces;
      this.name = name;
      this.trueValues = {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0};
      this.cancelledValues = {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0};
      this.success = 0;
      this.advantage = 0;
    }
    roll() {
      this.result = this.dieFaces[Math.floor(Math.random() * this.dieFaces.length)];
    }
    toString() {
      if (this.result != undefined){
        let str = "";
        str += this.name + '.'.repeat(12 - this.name.length);
        str += '.'.repeat(20 - this.result.face.length) + this.result.face;
        return str;
      } else {
        return this.name;
      }
    }
  }
  class Dice {
    constructor (diceCountArray) {
      this["Proficiency"] = diceCountArray[0],
      this["Ability"]     = diceCountArray[1],
      this["Boost"]       = diceCountArray[2],
      this["Challenge"]   = diceCountArray[3],
      this["Difficulty"]  = diceCountArray[4],
      this["Setback"]     = diceCountArray[5]
    }
  }
  class DicePool {
    constructor(diceCount, modifiers = null) {
      this.diceCount = diceCount;
      this.modifiers = modifiers;
      this.dice;
      this.totalCombos;
      this.results;
      this.trueValues;
      this.cancelledValues;
      this.success;
      this.advantage;
      this.poolSummary;

      this.setDice();
    }
    setDice(){
      this.dice = [];
      for (var i = 0; i < this.diceCount['Proficiency']; i++) this.dice.push(new Proficiency());
      for (var i = 0; i < this.diceCount['Ability']; i++) this.dice.push(new Ability());
      for (var i = 0; i < this.diceCount['Boost']; i++) this.dice.push(new Boost());
      for (var i = 0; i < this.diceCount['Challenge']; i++) this.dice.push(new Challenge());
      for (var i = 0; i < this.diceCount['Difficulty']; i++) this.dice.push(new Difficulty());
      for (var i = 0; i < this.diceCount['Setback']; i++) this.dice.push(new Setback());
      let combos = 1;
      for (var i = 0; i < this.dice.length; i++) combos *= this.dice[i].numFaces;
      this.totalCombos = combos;
    }
    roll() {
      this.results = [];
      this.trueValues = this.cancelledValues = undefined;
      this.poolSummary = this.advantage = this.success = undefined;
      for (var i = 0; i < this.dice.length; i++) {
        this.dice[i].roll();
        this.results.push(this.dice[i].result);
      }
      this.setTrueValues();
      this.setCancelledValues();
      this.setSuccess();
      this.setAdvantage();
      this.setPoolSummary();
    }
    setTrueValues() {
      this.trueValues = {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0}
      for (var result = 0; result < this.results.length; result++) {
        this.trueValues['s'] += this.results[result].value['s'];
        this.trueValues['a'] += this.results[result].value['a'];
        this.trueValues['f'] += this.results[result].value['f'];
        this.trueValues['t'] += this.results[result].value['t'];
        this.trueValues['T'] += this.results[result].value['T'];
        this.trueValues['D'] += this.results[result].value['D'];
      }
      if (this.modifiers != undefined){
        this.trueValues['s'] += this.modifiers['s'];
        this.trueValues['a'] += this.modifiers['a'];
        this.trueValues['f'] += this.modifiers['f'];
        this.trueValues['t'] += this.modifiers['t'];
        this.trueValues['T'] += this.modifiers['T'];
        this.trueValues['D'] += this.modifiers['D'];
      }
    }
    setCancelledValues(){
      this.cancelledValues = {'s': 0, 'a': 0, 'f': 0, 't': 0, 'T': 0, 'D': 0}
      this.cancelledValues['s'] = this.trueValues['s'] > this.trueValues['f'] ? this.trueValues['s'] - this.trueValues['f'] : 0;
      this.cancelledValues['a'] = this.trueValues['a'] > this.trueValues['t'] ? this.trueValues['a'] - this.trueValues['t'] : 0;
      this.cancelledValues['f'] = this.trueValues['f'] > this.trueValues['s'] ? this.trueValues['f'] - this.trueValues['s'] : 0;
      this.cancelledValues['t'] = this.trueValues['t'] > this.trueValues['a'] ? this.trueValues['t'] - this.trueValues['a'] : 0;
      this.cancelledValues['T'] = this.trueValues['T'];
      this.cancelledValues['D'] = this.trueValues['D'];
    }
    setSuccess() {
      this.success = this.getCancelledValues()['s'] > 0;
    }
    setAdvantage() {
      this.advantage = this.getCancelledValues()['a'] > 0;
    }
    setPoolSummary(){
      this.poolSummary = "";
      let str = "";
      let successes = this.cancelledValues['s'];
      let advantages = this.cancelledValues['a'];
      let triumphs = this.cancelledValues['T'];
      let failures = this.cancelledValues['f'];
      let threats = this.cancelledValues['t'];
      let despairs = this.cancelledValues['D'];
      if (successes > 0) str += successes + " SUCCESS" + (successes > 1 ? "ES" : "");
      if (advantages > 0) str += (str.length > 0 ? ", " : "") + advantages + " ADVANTAGE" + (advantages > 1 ? "S" : "");
      if (triumphs > 0) str += (str.length > 0 ? ", " : "") + triumphs + " TRIUMPH" + (triumphs > 1 ? "S" : "");
      if (failures > 0) str += (str.length > 0 ? ", " : "") + failures + " FAILURE" + (failures > 1 ? "S" : "");
      if (threats > 0) str += (str.length > 0 ? ", " : "") + threats + " THREAT" + (threats > 1 ? "S" : "");
      if (despairs > 0) str += (str.length > 0 ? ", " : "") + despairs + " DESPAIR" + (despairs > 1 ? "S" : "");
      this.poolSummary = str;
    }

    getDiceCount() {
      return this.diceCount;
    }
    getModifiers() {
      return this.modifiers;
    }
    getDice() {
      return this.dice;
    }
    getTotalCombos() {
      //this.totalCombos = this.totalCombos > 999999999999 ? Number.parseFloat(this.totalCombos).toExponential(2) : this.totalCombos.toLocaleString();
      return this.totalCombos;
    }
    getResults() {
      return this.results;
    }
    getTrueValues() {
      return this.trueValues;
    }
    getCancelledValues() {
      return this.cancelledValues;
    }
    getSuccess() {
      return this.success;
    }
    getAdvantage() {
      return this.advantage;
    }
    getPoolSummary() {
      return this.poolSummary;
    }
    toString() {
      let str = "";
      for (var i = 0; i < this.dice.length; i++) {
        str += this.dice[i].toString() + "\n";
      }
      return str;
    }
  }
  class DiceTrial {
    constructor(dicePool, numRolls){
      this.dicePool = dicePool;
      this.numRolls = numRolls;
      this.trials = [];
      this.results = [];
      this.totalValues;
      this.averageValues;
      this.trialSummary;
      this.cancelledTotalValues;
      this.cancelledAverageValues;
      this.cancelledtrialSummary;
    }
    runTrial() {
      for (var i = 0; i < this.numRolls; i++) {
        this.dicePool.roll();
        this.trials.push(this.dicePool.results);
        this.results.push(this.dicePool.getTrueValues());
      }
    }
    setTotalValues(){
      let totalValues = {'s': 0.0, 'a': 0.0, 'f': 0.0, 't': 0.0, 'T': 0.0, 'D': 0.0};
      for (var i = 0; i < this.results.length; i++) {
        totalValues['s'] += this.results[i]['s'];
        totalValues['a'] += this.results[i]['a'];
        totalValues['f'] += this.results[i]['f'];
        totalValues['t'] += this.results[i]['t'];
        totalValues['T'] += this.results[i]['T'];
        totalValues['D'] += this.results[i]['D'];
      }
      this.totalValues = totalValues;
    }
    setAverageValues(){
      (this.totalValues == undefined) && this.setTotalValues();
      this.averageValues = {'s': 0.0, 'a': 0.0, 'f': 0.0, 't': 0.0, 'T': 0.0, 'D': 0.0};
      for (var key in this.totalValues) {
        this.averageValues[key] = this.totalValues[key] / this.numRolls;
      }
    }
    setTrialSummary(){
      (this.averageValues == undefined) && this.setAverageValues();
      this.trialSummary = "";
      let str = `For ${this.numRolls} rolls, the average results are:\n`;
      let successes   = this.averageValues['s'].toFixed(3);
      let advantages  = this.averageValues['a'].toFixed(3);
      let triumphs    = this.averageValues['T'].toFixed(3);
      let failures    = this.averageValues['f'].toFixed(3);
      let threats     = this.averageValues['t'].toFixed(3);
      let despairs    = this.averageValues['D'].toFixed(3);
      if (successes > 0) str += successes + " SUCCESS" + (successes > 1 ? "ES" : "");
      if (advantages > 0) str += (str.length > 0 ? ", " : "") + advantages + " ADVANTAGE" + (advantages > 1 ? "S" : "");
      if (triumphs > 0) str += (str.length > 0 ? ", " : "") + triumphs + " TRIUMPH" + (triumphs > 1 ? "S" : "");
      if (failures > 0) str += (str.length > 0 ? ", " : "") + failures + " FAILURE" + (failures > 1 ? "S" : "");
      if (threats > 0) str += (str.length > 0 ? ", " : "") + threats + " THREAT" + (threats > 1 ? "S" : "");
      if (despairs > 0) str += (str.length > 0 ? ", " : "") + despairs + " DESPAIR" + (despairs > 1 ? "S" : "");
      this.trialSummary = str;
    }
    setCancelledTotalValues(){
      this.cancelledTotalValues = {'s': 0.0, 'a': 0.0, 'f': 0.0, 't': 0.0, 'T': 0.0, 'D': 0.0};
      this.cancelledTotalValues['s'] = this.totalValues['s'] > this.totalValues['f'] ? this.totalValues['s'] - this.totalValues['f'] : 0;
      this.cancelledTotalValues['a'] = this.totalValues['a'] > this.totalValues['t'] ? this.totalValues['a'] - this.totalValues['t'] : 0;
      this.cancelledTotalValues['f'] = this.totalValues['f'] > this.totalValues['s'] ? this.totalValues['f'] - this.totalValues['s'] : 0;
      this.cancelledTotalValues['t'] = this.totalValues['t'] > this.totalValues['a'] ? this.totalValues['t'] - this.totalValues['a'] : 0;
      this.cancelledTotalValues['T'] = this.totalValues['T'];
      this.cancelledTotalValues['D'] = this.totalValues['D'];
    }
    setCancelledAverageValues(){
      (this.averageValues == undefined) && this.setAverageValues();
      this.cancelledAverageValues = {'s': 0.0, 'a': 0.0, 'f': 0.0, 't': 0.0, 'T': 0.0, 'D': 0.0};
      this.cancelledAverageValues['s'] = this.averageValues['s'] > this.averageValues['f'] ? this.averageValues['s'] - this.averageValues['f'] : 0;
      this.cancelledAverageValues['a'] = this.averageValues['a'] > this.averageValues['t'] ? this.averageValues['a'] - this.averageValues['t'] : 0;
      this.cancelledAverageValues['f'] = this.averageValues['f'] > this.averageValues['s'] ? this.averageValues['f'] - this.averageValues['s'] : 0;
      this.cancelledAverageValues['t'] = this.averageValues['t'] > this.averageValues['a'] ? this.averageValues['t'] - this.averageValues['a'] : 0;
      this.cancelledAverageValues['T'] = this.averageValues['T'];
      this.cancelledAverageValues['D'] = this.averageValues['D'];
    }
    setCancelledTrialSummary(){
      (this.cancelledAverageValues == undefined) && this.setCancelledAverageValues();
      this.cancelledTrialSummary = "";
      let str = `For ${this.numRolls} rolls, adjusted for cross-cancelling, the average results are:\n`;
      let successes   = this.cancelledAverageValues['s'].toFixed(3);
      let advantages  = this.cancelledAverageValues['a'].toFixed(3);
      let triumphs    = this.cancelledAverageValues['T'].toFixed(3);
      let failures    = this.cancelledAverageValues['f'].toFixed(3);
      let threats     = this.cancelledAverageValues['t'].toFixed(3);
      let despairs    = this.cancelledAverageValues['D'].toFixed(3);
      if (successes > 0) str += successes + " SUCCESS" + (successes > 1 ? "ES" : "");
      if (advantages > 0) str += (str.length > 0 ? ", " : "") + advantages + " ADVANTAGE" + (advantages > 1 ? "S" : "");
      if (triumphs > 0) str += (str.length > 0 ? ", " : "") + triumphs + " TRIUMPH" + (triumphs > 1 ? "S" : "");
      if (failures > 0) str += (str.length > 0 ? ", " : "") + failures + " FAILURE" + (failures > 1 ? "S" : "");
      if (threats > 0) str += (str.length > 0 ? ", " : "") + threats + " THREAT" + (threats > 1 ? "S" : "");
      if (despairs > 0) str += (str.length > 0 ? ", " : "") + despairs + " DESPAIR" + (despairs > 1 ? "S" : "");
      this.cancelledTrialSummary = str;
    }

    getTrials(){
      return this.trials;
    }
    getTotalValues(){
      (this.totalValues == undefined) && this.setTotalValues();
      return this.totalValues;
    }
    getAverageValues(){
      (this.averageValues == undefined) && this.setAverageValues();
      return this.averageValues;
    }
    getTrialSummary(){
      (this.trialSummary == undefined) && this.setTrialSummary();
      return this.trialSummary;
    }
    getCancelledTotalValues(){
      (this.cancelledTotalValues == undefined) && this.setCancelledTotalValues();
      return this.cancelledTotalValues;
    }
    getCancelledAverageValues(){
      (this.cancelledAverageValues == undefined) && this.setCancelledAverageValues();
      return this.cancelledAverageValues;
    }
    getCancelledTrialSummary(){
    (this.cancelledTrialSummary == undefined) && this.setCancelledTrialSummary();
    return this.cancelledTrialSummary;
  }
  }

  class Proficiency extends Die {
    constructor() {
      super(12, "Proficiency");
      this.dieFaces = [
        new DieFace("BLANK"),
        new DieFace("SUCCESS"),
        new DieFace("SUCCESS"),
        new DieFace("ADVANTAGE"),
        new DieFace("SUCCESS ADVANTAGE"),
        new DieFace("SUCCESS ADVANTAGE"),
        new DieFace("SUCCESS ADVANTAGE"),
        new DieFace("DOUBLE SUCCESS"),
        new DieFace("DOUBLE SUCCESS"),
        new DieFace("DOUBLE ADVANTAGE"),
        new DieFace("DOUBLE ADVANTAGE"),
        new DieFace("TRIUMPH"),
      ];
      this.numFaces = this.dieFaces.length;
    }
  }
  class Ability extends Die {
    constructor() {
      super(8, "Ability");
      this.dieFaces = [
        new DieFace("BLANK"),
        new DieFace("SUCCESS"),
        new DieFace("SUCCESS"),
        new DieFace("ADVANTAGE"),
        new DieFace("ADVANTAGE"),
        new DieFace("SUCCESS ADVANTAGE"),
        new DieFace("DOUBLE SUCCESS"),
        new DieFace("DOUBLE ADVANTAGE"),
      ];
      this.numFaces = this.dieFaces.length;
    }
  }
  class Boost extends Die {
    constructor() {
      super(6, "Boost");
      this.dieFaces = [
        new DieFace("BLANK"),
        new DieFace("BLANK"),
        new DieFace("SUCCESS"),
        new DieFace("SUCCESS"),
        new DieFace("ADVANTAGE"),
        new DieFace("SUCCESS ADVANTAGE"),
      ];
      this.numFaces = this.dieFaces.length;
    }
  }
  class Challenge extends Die {
    constructor() {
      super(12, "Challenge");
      this.dieFaces = [
        new DieFace("BLANK"),
        new DieFace("FAILURE"),
        new DieFace("FAILURE"),
        new DieFace("THREAT"),
        new DieFace("THREAT"),
        new DieFace("FAILURE THREAT"),
        new DieFace("FAILURE THREAT"),
        new DieFace("DOUBLE FAILURE"),
        new DieFace("DOUBLE FAILURE"),
        new DieFace("DOUBLE THREAT"),
        new DieFace("DOUBLE THREAT"),
        new DieFace("DESPAIR"),
      ];
      this.numFaces = this.dieFaces.length;
    }
  }
  class Difficulty extends Die {
    constructor() {
      super(8, "Difficulty");
      this.dieFaces = [
        new DieFace("BLANK"),
        new DieFace("FAILURE"),
        new DieFace("THREAT"),
        new DieFace("THREAT"),
        new DieFace("THREAT"),
        new DieFace("FAILURE THREAT"),
        new DieFace("DOUBLE FAILURE"),
        new DieFace("DOUBLE THREAT"),
      ];
      this.numFaces = this.dieFaces.length;
    }
  }
  class Setback extends Die {
    constructor() {
      super(6, "Setback");
      this.dieFaces = [
        new DieFace("BLANK"),
        new DieFace("BLANK"),
        new DieFace("FAILURE"),
        new DieFace("FAILURE"),
        new DieFace("THREAT"),
        new DieFace("THREAT"),
      ];
      this.numFaces = this.dieFaces.length;
    }
  }

/*   // DieFace class tests
  console.log("\n\nDieFace tests __________________________");
  var dieFace = new DieFace("FAILURE");
  console.log(dieFace.value);
 */
/*   // Boost class tests
  var boost = new Boost();
  console.log("\n\nBoost tests __________________________");
  console.log(boost.dieFaces);
  console.log(boost.numFaces);
  console.log(boost.result); //result before roll
  console.log(boost.toString()); //boost.toString();
  boost.roll();
  console.log(boost.toString()); //boost.toString();
  console.log(boost.result); //DieFace object (face, possibleOutcomes, value);
  console.log(boost.result.face); //result after roll (TERM).
  console.log(boost.result.possibleOutcomes); //all possible outcomes
  console.log(boost.result.value); //result after roll: value ({s: X, a: X, f: X, t: X, T: X, D: X}).
 */
/*   // Dice, Modifiers, & DicePool class tests
  var dice = new Dice([0,4,2,2,3,3]);
  var modifiers = new Modifiers([0,0,0,0,1,0]);
  var dicePool  = new DicePool(dice, modifiers);
  console.log("dicePool tests __________________________");
    console.log("\tPre-roll tests:");
      console.log("\t\tresults: ");
        console.log(dicePool.results);
      console.log("\t\tgetDiceCount(): ");
        console.log(dicePool.getDiceCount());
  dicePool.roll();
  console.log("⚠ Dice Pool has been rolled! ⚠");
    console.log("\tPost-roll tests:");
      console.log("\t\tresults: ");
        console.log(dicePool.results);
      console.log("\t\ttoSring(): ");
        console.log(dicePool.toString());
      console.log("\t\tgetModifiers(): ");
        console.log(dicePool.getModifiers());
      console.log("\t\tgetTrueValues(): ");
        console.log(dicePool.getTrueValues());
      console.log("\t\tgetCancelledValues(): ");
        console.log(dicePool.getCancelledValues());
      console.log("\t\tgetSuccess(): ");
        console.log(dicePool.getSuccess());
      console.log("\t\tgetAdvantage(): ");
        console.log(dicePool.getAdvantage());
      console.log("\t\tgetPoolSummary(): ");
        console.log(dicePool.getPoolSummary());
 */
/*   // DiceTrial class tests
  const NUM_ROLLS = 100000;

  var dice = new Dice([1,4,2,2,3,3]);
  var modifiers = new Modifiers([0,0,0,0,1,0]);
  var dicePool  = new DicePool(dice, modifiers);
  var diceTrial = new DiceTrial(dicePool, NUM_ROLLS);
  
  console.log("\nDiceTrial tests __________________________");

  diceTrial.runTrial();
  console.log("⚠ Dice Trial has been run! ⚠");

  console.log("\ndiceTrial.getTrials()");
    console.log(diceTrial.getTrials());
  console.log("\ndiceTrial.getTotalValues()");
    console.log(diceTrial.getTotalValues());
  console.log("\ndiceTrial.getAverageValues()");
    console.log(diceTrial.getAverageValues());
  console.log("\ndiceTrial.getTrialSummary()");
    console.log(diceTrial.getTrialSummary());
  console.log("\ndiceTrial.getCancelledTotalValues()");
    console.log(diceTrial.getCancelledTotalValues());
  console.log("\ndiceTrial.getCancelledAverageValues()");
    console.log(diceTrial.getCancelledAverageValues());
  console.log("\ndiceTrial.getCancelledTrialSummary()");
    console.log(diceTrial.getCancelledTrialSummary());
 */

  $(document).ready(function(){
    //SECTION: INITIALIZATION
    initialized = false;
    $(function (){$('[data-toggle="tooltip"]').tooltip();});

    var dicePoolShown = false;
    var summaryShown = false;
    var rollsShown = false;
    var graphsShown = false;
    var numRolls;
    var numDice;
    var numModifiers;
    var numIconTypes;

    const
      BUFFS = ["Proficiency", "Ability", "Boost"],
      DEBUFFS = ["Challenge", "Difficulty", "Setback"],
      DICE_TYPES = ["Proficiency", "Ability", "Boost", "Challenge", "Difficulty", "Setback"],
      POSITIVE_OUTCOMES = ["SUCCESS", "ADVANTAGE", "TRIUMPH"],
      NEGATIVE_OUTCOMES = ["FAILURE", "THREAT", "DESPAIR"],
      POSITIVE_ICONS = BUFFS.concat(POSITIVE_OUTCOMES),
      NEGATIVE_ICONS = DEBUFFS.concat(NEGATIVE_OUTCOMES),
      OUTCOMES = ["SUCCESS", "ADVANTAGE", "TRIUMPH", "FAILURE", "THREAT", "DESPAIR"],
      ALL_ICONS = POSITIVE_ICONS.concat(NEGATIVE_ICONS);

    $('#dice-pool').hide();
    $('#summary').hide();
    $('#rolls').hide();
    $('#graphs').hide();
  
    //SECTION: EVENT HANDLERS
    // When any dice or modifier input is changed...
    $('.form-control').change(function(){
      $('#total-roll-combos').html('Total Distinct Rolls: ' + getTotalRollCombos());
    });
    function getTotalRollCombos(){
      /*
        These multipliers might look weird, why don't they just get the numFaces value?
        well, the numFaces value is the number of faces on the die, but the total 
        number of combos is the computed number of possible results.
        These dice have repeat faces, so the number of possible results is not the same.
        The multiplier then becomes the number of -distinct- faces on the die.
      */
      let proficiencyCombos = Math.pow(7, parseInt($('#proficiency-input').val()));
      let abilityCombos = Math.pow(6, parseInt($('#ability-input').val()));
      let boostCombos = Math.pow(5, parseInt($('#boost-input').val()));
      let challengeCombos = Math.pow(7, parseInt($('#challenge-input').val()));
      let difficultyCombos = Math.pow(6, parseInt($('#difficulty-input').val()));
      let setbackCombos = Math.pow(3, parseInt($('#setback-input').val()));
      proficiencyCombos = proficiencyCombos == 0 ? 1 : proficiencyCombos;
      abilityCombos = abilityCombos == 0 ? 1 : abilityCombos;
      boostCombos = boostCombos == 0 ? 1 : boostCombos;
      challengeCombos = challengeCombos == 0 ? 1 : challengeCombos;
      difficultyCombos = difficultyCombos == 0 ? 1 : difficultyCombos;
      setbackCombos = setbackCombos == 0 ? 1 : setbackCombos;

      numCombos = proficiencyCombos*abilityCombos*boostCombos*challengeCombos*difficultyCombos*setbackCombos;
      return numCombos.toLocaleString();
    }

    $("#run-trials").click(function(){
      disableTrialBtn();
      
      //Input & Declarations
      var dice = new Dice([
        parseInt($('#proficiency-input').val()),
        parseInt($('#ability-input').val()),
        parseInt($('#boost-input').val()),
        parseInt($('#challenge-input').val()),
        parseInt($('#difficulty-input').val()),
        parseInt($('#setback-input').val()),
      ]);
      numDice = parseInt($('#proficiency-input').val()) + parseInt($('#ability-input').val()) + parseInt($('#boost-input').val()) + parseInt($('#challenge-input').val()) + parseInt($('#difficulty-input').val()) + parseInt($('#setback-input').val());
      var modifiers = new Modifiers([
        parseInt($('#success-input').val()),
        parseInt($('#advantage-input').val()),
        parseInt($('#failure-input').val()),
        parseInt($('#threat-input').val()),
        parseInt($('#triumph-input').val()),
        parseInt($('#despair-input').val()),
      ]);
      numModifiers = parseInt($('#success-input').val()) + parseInt($('#advantage-input').val()) + parseInt($('#failure-input').val()) + parseInt($('#threat-input').val()) + parseInt($('#triumph-input').val()) + parseInt($('#despair-input').val());
      numIconTypes = numDice + numModifiers;
      numRolls = parseInt($('#roll-number-input').val());
      let dicePool  = new DicePool(dice, modifiers);
      let diceTrial = new DiceTrial(dicePool, numRolls);

      //Processing
      if (numIconTypes > 0){
        let startTime = performance.now();

        diceTrial.runTrial();
        trialSummary = diceTrial.getTrialSummary();
        cancelledTrialSummary = diceTrial.getCancelledTrialSummary();

        //Output
        updateIconStrip();
        let totalValues = diceTrial.getTotalValues();
        let averageValues = diceTrial.getAverageValues();
        let cancelledTotalValues = diceTrial.getCancelledTotalValues();
        let cancelledAverageValues = diceTrial.getCancelledAverageValues();
        updateResultsTable(totalValues, averageValues, cancelledTotalValues, cancelledAverageValues);
        $('#roll-count-label').html(`After cross-cancellation and ${numRolls.toLocaleString()} rolls, the average results of the dice pool above is:`);
        updateTrialSummary(cancelledAverageValues);
        showSummary();

        let endTime = performance.now();
        let timeDiff = (endTime - startTime)/1000; // function run time in seconds
        $('#run-time').html(`<i>Roll trial completed in ${timeDiff.toFixed(4)} seconds</i>`);
      }

      enableTrialBtn();
      return;
    });
    //run-trials helper methods
    $(document).keydown(function(e) {
      if (e.which == 13) { // 13 is the key code for Enter
        if ($('#run-trials').is(":disabled")){
          return;
        }
        $('#run-trials').click();
      }
    });
    function disableTrialBtn(){
      $('#run-trials').prop('disabled', true);
      $('#run-trials').addClass('btn-secondary');
      $('#run-trials').removeClass('btn-primary');
    }
    function enableTrialBtn(){
      $('#run-trials').prop('disabled', false);
      $('#run-trials').addClass('btn-primary');
      $('#run-trials').removeClass('btn-secondary');
    }
    function updateTotals(totalValues){
      $('#total-success').html(totalValues['s']);
      $('#total-advantage').html(totalValues['a']);
      $('#total-failure').html(totalValues['f']);
      $('#total-threat').html(totalValues['t']);
      $('#total-triumph').html(totalValues['T']);
      $('#total-despair').html(totalValues['D']);
    }
    function updateAverages(averageValues){
      $('#average-success').html(averageValues['s'].toFixed(3));
      $('#average-advantage').html(averageValues['a'].toFixed(3));
      $('#average-failure').html(averageValues['f'].toFixed(3));
      $('#average-threat').html(averageValues['t'].toFixed(3));
      $('#average-triumph').html(averageValues['T'].toFixed(3));
      $('#average-despair').html(averageValues['D'].toFixed(3));
    }
    function updateAdjustedTotals(cancelledTotalValues){
      $('#adjusted-total-success').html(cancelledTotalValues['s']);
      $('#adjusted-total-advantage').html(cancelledTotalValues['a']);
      $('#adjusted-total-failure').html(cancelledTotalValues['f']);
      $('#adjusted-total-threat').html(cancelledTotalValues['t']);
      $('#adjusted-total-triumph').html(cancelledTotalValues['T']);
      $('#adjusted-total-despair').html(cancelledTotalValues['D']);
    }
    function updateAdjustedAverages(cancelledAverageValues){
      $('#adjusted-average-success').html(cancelledAverageValues['s'].toFixed(3));
      $('#adjusted-average-advantage').html(cancelledAverageValues['a'].toFixed(3));
      $('#adjusted-average-failure').html(cancelledAverageValues['f'].toFixed(3));
      $('#adjusted-average-threat').html(cancelledAverageValues['t'].toFixed(3));
      $('#adjusted-average-triumph').html(cancelledAverageValues['T'].toFixed(3));
      $('#adjusted-average-despair').html(cancelledAverageValues['D'].toFixed(3));
    }
    function updateResultsTable(totalValues, averageValues, cancelledTotalValues, cancelledAverageValues){
      updateTotals(totalValues);
      updateAverages(averageValues);
      updateAdjustedTotals(cancelledTotalValues);
      updateAdjustedAverages(cancelledAverageValues);
    }
    //Rolls > Dice Icon Strip
    const
      DICE_STRIP_ICON_WIDTH   = 25,
      DICE_STRIP_ICON_SPACING = 2,
      DICE_STRIP_MAX_ICONS    = 38;
    function appendIcons(container, name = "blank", count = DICE_STRIP_ICON_SPACING){
      for (i=0; i<count; i++) {
        let img = document.createElement("img");
        img.src=`./images/${name}.png`;
        img.height=DICE_STRIP_ICON_WIDTH;
        img.width=DICE_STRIP_ICON_WIDTH;
        container.append(img);
      }
    }
    function appendIconCount(container, name, count){
      // for cases where the total number of icons exceeds 40,
      // show a singular dice type icon followed by it's count.

      //append the image icon
      let iconImg = document.createElement("img");
      iconImg.src=`./images/${name}.png`;
      iconImg.height=DICE_STRIP_ICON_WIDTH;
      iconImg.width=DICE_STRIP_ICON_WIDTH;
      container.append(iconImg);
      //append the count
      let countLabel = document.createElement("span");
      countLabel.innerHTML = "x" + count;
      $(countLabel).addClass('h6');
      $(countLabel).addClass('pl-1');
      container.append(countLabel);
      //append the blank icon
      let blankImg = document.createElement("img");
      blankImg.src=`./images/blank.png`;
      blankImg.height=DICE_STRIP_ICON_WIDTH;
      blankImg.width=DICE_STRIP_ICON_WIDTH;
      container.append(blankImg);

    }
    function updateIconStrip(){
      let container = $('#dice-icon-strip');
      container.empty();
      let name = "";

      if (numIconTypes <= DICE_STRIP_MAX_ICONS){
        for (let i = 0; i < POSITIVE_ICONS.length; i++){
          name = (POSITIVE_ICONS[i]).toLowerCase();
          let suffix = POSITIVE_OUTCOMES.includes((POSITIVE_ICONS[i]).toUpperCase()) ? "-light" : "";
          let count = parseInt($(`#${name}-input`).val());
          appendIcons(container, name + suffix, count);
        }
        
        //blanks for spacing
        appendIcons(container);

        for (let i = 0; i < NEGATIVE_ICONS.length; i++){
          name = (NEGATIVE_ICONS[i]).toLowerCase();
          let suffix = NEGATIVE_OUTCOMES.includes((NEGATIVE_ICONS[i]).toUpperCase()) ? "-light" : "";
          let count = parseInt($(`#${name}-input`).val());
          appendIcons(container, name + suffix, count);
        }

      } else {
        for (let i = 0; i < ALL_ICONS.length; i++){
          name = (ALL_ICONS[i]).toLowerCase();
          let count = parseInt($(`#${name}-input`).val());
          if (count > 0){
            if (OUTCOMES.includes(name.toUpperCase())){
              name += "-light";
            }
            appendIconCount(container, name, count);
          }
        }
      }
    }
    //Rolls > Trial Summary
    function updateTrialSummary(cancelledAverageValues){
      let success = cancelledAverageValues['s'] > cancelledAverageValues['f'];
      let advantage = cancelledAverageValues['a'] > cancelledAverageValues['t'];
      let numSuccessFailure = Math.abs(cancelledAverageValues['s'] - cancelledAverageValues['f']);
      let numAdvantageThreat = Math.abs(cancelledAverageValues['a'] - cancelledAverageValues['t']);
      let successCountElem = $('#trial-summary-success-count');
      let successIconContainer = $('#trial-summary-success-label-icon');
      let successLabelElem = $('#trial-summary-success-label-text');
      let advantageCountElem = $('#trial-summary-advantage-count');
      let advantageIconContainer = $('#trial-summary-advantage-label-icon');
      let advantageLabelElem = $('#trial-summary-advantage-label-text');
      successCountElem.empty();
      successIconContainer.empty();
      successLabelElem.empty();
      advantageCountElem.empty();
      advantageIconContainer.empty();
      advantageLabelElem.empty();

      //BOX-SHADOW
      //success/failure
      successBox= $('#success-summary-box');
      successBox.prop('style', `border-radius: 20px; box-shadow: 0px 0px 20px 10px ${success ? 'green' : 'red'} inset;`);
      //advantage/threat
      advantageBox= $('#advantage-summary-box');
      advantageBox.prop('style', `border-radius: 20px; box-shadow: 0px 0px 20px 10px ${advantage ? 'green' : 'red'} inset;`);

      
      //SUCCESS/FAILURE
      if (numAdvantageThreat > 0){
        
      }
      //count label 
      let successCountText = "  ≈" + numSuccessFailure.toFixed(1);
      successCountElem.html(successCountText);
      //icon
      let successFailureImgSrc = success ? 'images/success-light.png' : 'images/failure-light.png';
      let successFailureImg = document.createElement('img');
      successFailureImg.src = successFailureImgSrc;
      $(successFailureImg).prop('style', 'height: 6rem; width: auto;');
      successIconContainer.append(successFailureImg);
      //text label
      let successText = success ? 'SUCCESSES' : 'FAILURES';
      successLabelElem.removeClass('text-success');
      successLabelElem.removeClass('text-danger');
      successLabelElem.addClass(success ? 'text-success' : 'text-danger');
      successLabelElem.html(successText);

      
      //ADVANTAGE/THREAT
      //count label
      let advantageCountText = "  ≈" + (numAdvantageThreat.toFixed(1));
      advantageCountElem.html(advantageCountText);
      //icon 
      let advantageThreatImgSrc = advantage ? 'images/advantage-light.png' : 'images/threat-light.png';
      let advantageThreatImg = document.createElement('img');
      advantageThreatImg.src = advantageThreatImgSrc;
      $(advantageThreatImg).prop('style', 'height: 6rem; width: auto;');
      advantageIconContainer.append(advantageThreatImg);
      //text label
      let advantageText = advantage ? 'ADVANTAGES' : 'THREATS';
      advantageLabelElem.removeClass('text-success');
      advantageLabelElem.removeClass('text-danger');
      advantageLabelElem.addClass(advantage ? 'text-success' : 'text-danger');
      advantageLabelElem.html(advantageText);
    }

    
    // SECTION: SITE SECTION FOLDING
    const FOLDING_SPEED = 250; //milliseconds
    //Folding Toolkit
    function showSection(jButton, jSection, label, speed=FOLDING_SPEED){
      jButton.html(label);
      jButton.addClass('disabled');
      jSection.slideDown(speed);
    }
    function hideSection(jButton, jSection, label, speed=FOLDING_SPEED){
      jButton.html(label + " ▼");
      jButton.removeClass('disabled');
      jSection.slideUp(speed);
    }
    // Dice Pool Folding
    function hideDicePool(){
      disableTrialBtn();
      hideSection($('#dice-pool-collapse'), $('#dice-pool'), "Dice Pool");
      dicePoolShown = false;
    }
    function showDicePool(){
      let speed = !initialized ? 1 : FOLDING_SPEED; 
      showSection($('#dice-pool-collapse'), $('#dice-pool'), "Dice Pool", speed);
      hideRolls();
      hideSummary();
      //hideGraphs();
      enableTrialBtn();
      dicePoolShown = true;
    }
    function toggleDicePool(){dicePoolShown ? hideDicePool() : showDicePool();}
    $('#dice-pool-collapse').click(toggleDicePool);
    // Summary Folding
    function hideSummary(){
      hideSection($('#summary-collapse'), $('#summary'), "Summary");
      summaryShown = false;
    }
    function showSummary(){
      showSection($('#summary-collapse'), $('#summary'), "Summary");
      hideDicePool();
      hideRolls();
      //hideGraphs();
      summaryShown = true;
    }
    function toggleSummary(){summaryShown ? hideSummary() : showSummary();}
    $('#summary-collapse').click(toggleSummary);

    // Rolls Folding
    function hideRolls(){
      hideSection($('#rolls-collapse'), $('#rolls'), "Rolls Table");
      rollsShown = false;
    }
    function showRolls(){
      showSection($('#rolls-collapse'), $('#rolls'), "Rolls Table");
      hideDicePool();
      hideSummary();
      //hideGraphs();
      rollsShown = true;
    }
    function toggleRolls(){rollsShown ? hideRolls() : showRolls();}
    $('#rolls-collapse').click(toggleRolls);
    // Graphs Folding
    function hideGraphs(){
      hideSection($('#graphs-collapse'), $('#graphs'), "Graphs");
      graphsShown = false;
    }
    function showGraphs(){
      showSection($('#graphs-collapse'), $('#graphs'), "Graphs");
      hideDicePool();
      hideRolls();
      graphsShown = true;
    }
    function toggleGraphs(){graphsShown ? hideGraphs() : showGraphs();}
    $('#graphs-collapse').click(toggleGraphs);


    //SECTION: FINISHED INITIAL LOADING
    toggleDicePool(true);
    initialized = true;
  });
</script>
</head>
<body class="bg-dark">
  <!--Main Container-->
  <div class="container-fluid bg-primary" style="width:60%">
    <!--Header-->
    <div class="bg-dark">
      <div class="display-4 text-center text-light">Dice Pool Likelihood Calculator</div>
      <div class="h3 text-center text-light"><i>A Monte Carlo simulator for Star Wars FFG & Gensys dice systems</i></div>
      <div class="text-center text-secondary"><i>See also: <a href="https://docs.google.com/spreadsheets/d/1ZlrbbYkT4C5emlW8wFVDMLSh2nv6tNJTk5SwY_LUc6k/copy?usp=sharing" data-toggle="tooltip" data-placement="top" title="This is a sheet detailing the odds of getting any given result from any number of dice.">Google Sheets - Dice Probability Breakdown🔗</a></i></div>
    </div>
    <!--Dice Pool & Trials Collapser-->
    <div style="width:100%;">
      <button id="dice-pool-collapse" class="btn btn-primary btn-lg btn-block border-bottom" style="width:100%;">Dice Pool ▼</i></button>
    </div>
    <!--Dice Pool & Trials-->
    <div id="dice-pool" class="container-fluid bg-dark text-light border" style="width:100%"> 
      <!-- Dice Pool -->
      <div class="row pt-2">
        <!-- Proficiency -->
        <div class="col col-2 text-center">
          <img src="./images/proficiency.png" class="img-fluid" alt="proficiency icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="proficiency-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Proficiency dice in the pool."/>
            </div>
          </div>
          <h3 id="proficiency-label"   class="">Proficiency  </h3>
        </div>
        <!-- Ability -->
        <div class="col col-2 text-center">
          <img src="./images/ability.png" class="img-fluid" alt="ability icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="ability-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Ability dice in the pool."/>
            </div>
          </div>
          <h3 id="ability-label"       class="">Ability      </h3>
        </div>
        <!-- Boost -->
        <div class="col col-2 text-center">
          <img src="./images/boost.png" class="img-fluid" alt="boost icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="boost-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Boost dice in the pool."/>
            </div>
          </div>
          <h3 id="boost-label"         class="">Boost        </h3>
        </div>
        <!-- Challenge -->
        <div class="col col-2 text-center">
          <img src="./images/challenge.png" class="img-fluid" alt="challenge icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="challenge-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Challenge dice in the pool."/>
            </div>
          </div>
          <h3 id="challenge-label"     class="">Challenge    </h3>
        </div>
        <!-- Difficulty -->
        <div class="col col-2 text-center">
          <img src="./images/difficulty.png" class="img-fluid" alt="difficulty icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="difficulty-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Difficulty dice in the pool."/>
            </div>
          </div>
          <h3 id="difficulty-label"    class="">Difficulty   </h3>
        </div>
        <!-- Setback -->
        <div class="col col-2 text-center">
          <img src="./images/setback.png" class="img-fluid" alt="setback icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="setback-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Setback dice in the pool."/>
            </div>
          </div>
          <h3 id="setback-label"       class="">Setback      </h3>
        </div>
      </div
      ><!-- Modifiers -->
      <div class="row">
        <!-- Success -->
        <div class="col col-2 text-center">
          <img src="./images/success-light.png" class="img-fluid" alt="success icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="success-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Success bonuses in the pool."/>
            </div>
          </div>
          <h3 id="success-label"       class="">Success      </h3>
        </div>
        <!-- Advantage -->
        <div class="col col-2 text-center">
          <img src="./images/advantage-light.png" class="img-fluid" alt="advantage icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="advantage-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Advantage bonuses in the pool."/>
            </div>
          </div>
          <h3 id="advantage-label"     class="">Advantage    </h3>
        </div>
        <!-- Triumph -->
        <div class="col col-2 text-center">
          <img src="./images/triumph-light.png" class="img-fluid" alt="triumph icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="triumph-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Triumph bonuses in the pool."/>
            </div>
          </div>
          <h3 id="triumph-label"       class="">Triumph      </h3>
        </div>
        <!-- Failure -->
        <div class="col col-2 text-center">
          <img src="./images/failure-light.png" class="img-fluid" alt="failure icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="failure-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Failure bonuses in the pool."/>
            </div>
          </div>
          <h3 id="failure-label"       class="">Failure      </h3>
        </div>
        <!-- Threat -->
        <div class="col col-2 text-center">
          <img src="./images/threat-light.png" class="img-fluid" alt="threat icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="threat-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Threat bonuses in the pool."/>
            </div>
          </div>
          <h3 id="threat-label"        class="">Threat       </h3>
        </div>
        <!-- Despair -->
        <div class="col col-2 text-center">
          <img src="./images/despair-light.png" class="img-fluid" alt="despair icon" style="height:30%">
          <div class="d-flex justify-content-center">
            <div class="form-outline" style="width:60%;">
              <input type="number" id="despair-input" class="form-control text-right h3" value="0" min="0" data-toggle="tooltip" data-placement="top" title="The number of Despair bonuses in the pool."/>
            </div>
          </div>
          <h3 id="despair-label"       class="">Despair      </h3>
        </div>
      </div>
      <!--Trials-->
      <div class="container-fluid">
        <!-- Number of Rolls & Run Trials -->
        <div class="d-flex justify-content-center row">
          <div id="total-roll-combos" class="text-center" data-toggle="tooltip" data-placement="top" title="This represents the total number of distinct arrangements of the dice pool.">Total Distinct Rolls: 0</div>
          <div class="form-outline input-group" style="width:40%">
            <div class="input-group-prepend">
              <span class="input-group-text" style="border-radius: 10px 0 0 10px;">Number of Rolls:</span>
            </div>
            <input type="number" id="roll-number-input" class="form-control text-center h3" value="1000000" min="0"/>
            <div class="input-group-append">
              <button id="run-trials" class="myButton btn btn-primary" type="button" data-toggle="tooltip" data-placement="top" title="Start the calculation." style="border-radius: 0 10px 10px 0;">Roll <i class="fa-solid fa-caret-right"></i></button>
            </div>
          </div>
          <div class="h6 text-center text-secondary"><i>Recommended Number of Rolls: 1,000,000</i></div>
        </div>
      </div>
    </div>
    <!--Summary Collapser-->
    <div style="width:100%;">
      <button id="summary-collapse" class="btn btn-primary btn-lg btn-block border-bottom disabled" style="width:100%;">Summary ▼</i></button>
    </div>
    <!--Summary-->
    <div id="summary" class="bg-dark text-light border">
      <!--Icon Strip-->
      <div class="d-flex justify-content-center mb-2 mt-2">
        <div id="dice-icon-strip"></div>
      </div>
      <!--Roll Count-->
      <div class="d-flex justify-content-center">
        <div id="roll-count-label" class="h4 text-center" style="width: 90%;"></div>
      </div>
      <!--Trial Summary-->
      <div class="d-flex justify-content-center p-3">
        <div class="container row" style="width: 90%; max-height: 13%;">
          <!--Successes/Failures-->
          <div id="success-summary-box" class="col p-4">
            <div class="row align-items-center">
              <div id="trial-summary-success-label-icon" class="col-3 justify-content-center" ></div>
              <div id="trial-summary-success-count" class="col display-4"></div>
            </div>
            <div class="row d-flex justify-content-center">
              <div id="trial-summary-success-label-text" class="col-6 display-4" style="width: 100%;"></div>
            </div>
          </div>
          <div class="col-1"></div>
          <!--Advantages/Threats-->
          <div id="advantage-summary-box" class="col p-4">
            <div class="row align-items-center text-right">
              <div id="trial-summary-advantage-label-icon" class="col-3 justify-content-center"></div>
              <div id="trial-summary-advantage-count" class="col display-4"></div>
            </div>
            <div class="row d-flex justify-content-center">
              <div id="trial-summary-advantage-label-text" class="col-6 display-4" style="width: 100%;"></div>
            </div> 
          </div>
        </div>
      </div>
      <!--Run Time-->
      <div class="d-flex justify-content-center text-center">
        <div id="run-time" class="text-secondary" style="width: 90%;"></div>
      </div>
    </div>
    <!--Rolls Collapser-->
    <div style="width:100%;">
      <button id="rolls-collapse" class="btn btn-primary btn-lg btn-block border-bottom disabled" style="width:100%;">Rolls Table ▼</button>
    </div>
    <!--Rolls Table-->
    <div id="rolls" class="bg-dark text-light border">
      <!-- Results Table -->
      <div class="d-flex justify-content-center">
        <table id="results-table" class="table table-striped table-bordered text-light bg-dark" style="width: 90%;">
          <thead>
            <tr>
              <th scope="col" style="width:20%"></th>
              <th scope="col">
                <div class="d-flex justify-content-center">
                  <img src="./images/success-light.png" class="img-fluid" alt="success icon" style="height:30%; width:30%;">
                </div>
                <div class="text-center">Success(es)</div>
              </th>
              <th scope="col">
                <div class="d-flex justify-content-center">
                  <img src="./images/advantage-light.png" class="img-fluid" alt="success icon" style="height:30%; width:30%;">
                </div>
                <div class="text-center">Advantage(s)</div>
              </th>
              <th scope="col">
                <div class="d-flex justify-content-center">
                  <img src="./images/triumph-light.png" class="img-fluid" alt="success icon" style="height:30%; width:30%;">
                </div>
                <div class="text-center">Triumph(s)</div>
              </th>
              <th scope="col">
                <div class="d-flex justify-content-center">
                  <img src="./images/failure-light.png" class="img-fluid" alt="success icon" style="height:30%; width:30%;">
                </div>
                <div class="text-center">Failure(s)</div>
              </th>
              <th scope="col">
                <div class="d-flex justify-content-center">
                  <img src="./images/threat-light.png" class="img-fluid" alt="success icon" style="height:30%; width:30%;">
                </div>
                <div class="text-center">Threat(s)</div>
              </th>
              <th scope="col">
                <div class="d-flex justify-content-center">
                  <img src="./images/despair-light.png" class="img-fluid" alt="success icon" style="height:30%; width:30%;">
                </div>
                <div class="text-center">Despair(s)</div>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <tr class="text-center">
                <th scope="row" data-toggle="tooltip" data-placement="top" title="The sum of the all symbols resulting from all rolls.">Total</th>
                <td id="total-success">0</td>
                <td id="total-advantage">0</td>
                <td id="total-triumph">0</td>
                <td id="total-failure">0</td>
                <td id="total-threat">0</td>
                <td id="total-despair">0</td>
              </tr>
            </tr>
            <tr>
              <tr class="text-center">
                <th scope="row" data-toggle="tooltip" data-placement="top" title="The sum of the all symbols resulting from all rolls, adjusted for cross-cancelling.">Adjusted Total</th>
                <td id="adjusted-total-success">0</td>
                <td id="adjusted-total-advantage">0</td>
                <td id="adjusted-total-triumph">0</td>
                <td id="adjusted-total-failure">0</td>
                <td id="adjusted-total-threat">0</td>
                <td id="adjusted-total-despair">0</td>
              </tr>
            </tr>
            <tr>
              <tr class="text-center">
                <th scope="row" data-toggle="tooltip" data-placement="top" title="The sum of the all symbols resulting from all rolls, divided by the number of rolls.">Average</th>
                <td id="average-success">0</td>
                <td id="average-advantage">0</td>
                <td id="average-triumph">0</td>
                <td id="average-failure">0</td>
                <td id="average-threat">0</td>
                <td id="average-despair">0</td>
              </tr>
            </tr>
            <tr>
              <tr class="text-center">
                <th scope="row" data-toggle="tooltip" data-placement="top" title="The sum of the all symbols resulting from all rolls, divided by the number of rolls, .">Adjusted Average</th>
                <td id="adjusted-average-success">0</td>
                <td id="adjusted-average-advantage">0</td>
                <td id="adjusted-average-triumph">0</td>
                <td id="adjusted-average-failure">0</td>
                <td id="adjusted-average-threat">0</td>
                <td id="adjusted-average-despair">0</td>
              </tr>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <!--Graphs Collapser-->
    <div style="width:100%;">
      <button id="graphs-collapse" class="btn btn-primary btn-lg btn-block" style="width:100%;" disabled>🚧Graphs ▼🚧</i></button>
    </div>
    <!--Graphs-->
    <div id="graphs" class="bg-light">
      <h3>Symbol Count Bell Curves</h3>
      <div class="d-flex justify-content-center">
        <p>delete me</p>
      </div>

    </div>

  </div>
</body>
</html>
